<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å¹¿æ’­å‰§è¿½è¸ª</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;600;700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: #f0e4cc; }
    ::-webkit-scrollbar-thumb { background: #c8a880; border-radius: 3px; }
    @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    @keyframes pulse { 0%,100% { opacity: 1; } 50% { opacity: 0.6; } }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .drama-card:hover { transform: translateY(-2px); box-shadow: 0 8px 30px rgba(120,60,20,0.18) !important; }
    .drama-card { transition: transform 0.2s, box-shadow 0.2s; }
    .tab-btn:hover { background: #e8d5b8 !important; }
    input:focus { border-color: #c8885a !important; box-shadow: 0 0 0 3px rgba(200,136,90,0.15); }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useMemo } = React;

    const initialDramas = [
      { id: 1, title: "å¤©å®˜èµç¦", rating: 4.9, male_lead: "èŠ±åŸ / è°¢æ€œ", cv: "é™ˆå¼ å¤ªåº· / è‹å°šå¿", author: "å¢¨é¦™é“œè‡­", tags: ["å¤é£"], sweetness: "å¾®è‹¦", cleanliness: "åŒæ´", review: "éœ‡æ’¼", review_note: "åŠ¨ç”» ç¬¬ä¸‰å­£å®Œç»“", adaptations: ["åŠ¨ç”»"], ongoing: false, favorited: true, synopsis: "èŠ±åŸä¸è°¢æ€œè·¨è¶Šå…«ç™¾å¹´çš„çˆ±æ‹ï¼Œä»å¤©ç¥åˆ°é¬¼ç‹ï¼Œä¸ç¦»ä¸å¼ƒã€‚", cv_list: ["é™ˆå¼ å¤ªåº·", "è‹å°šå¿"] },
      { id: 2, title: "é­”é“ç¥–å¸ˆ", rating: 4.6, male_lead: "è“å¿˜æœº / é­æ— ç¾¡", cv: "è¾¹æ±Ÿ / è‚–æˆ˜", author: "å¢¨é¦™é“œè‡­", tags: ["å¤é£"], sweetness: "å¾®è‹¦", cleanliness: "åŒæ´", review: "æ·±æ²‰", review_note: "åŠ¨ç”»", adaptations: ["åŠ¨ç”»"], ongoing: false, favorited: true, synopsis: "é­æ— ç¾¡ä¸è“å¿˜æœºï¼Œä¹±ä¸–ä¸­ä¸€æ®µè¡æ°”å›è‚ çš„çˆ±æƒ…ã€‚", cv_list: ["è¾¹æ±Ÿ", "è‚–æˆ˜"] },
      { id: 3, title: "æ’’é‡", rating: 4.7, male_lead: "è’‹ä¸ / é¡¾é£", cv: "å€’éœ‰æ­»å‹¿ / æ¹›æ£ ", author: "å·«å“²", tags: ["æ ¡å›­"], sweetness: "è‹¦", cleanliness: "åŒæ´", review: "æ•‘èµ", review_note: "", adaptations: [], ongoing: false, favorited: false, synopsis: "ä¸¤ä¸ªç ´ç¢çš„çµé­‚åœ¨æ ¡å›­é‡Œç›¸é‡ï¼Œç”¨çˆ±æ²»æ„ˆå½¼æ­¤çš„ä¼¤ã€‚", cv_list: ["å€’éœ‰æ­»å‹¿", "æ¹›æ£ "] },
      { id: 4, title: "æŸæŸ", rating: 4.6, male_lead: "æ±Ÿæ·» / ç››æœ›", cv: "é’±æ–‡é’ / éƒ‘å¸Œ", author: "æœ¨è‹é‡Œ", tags: ["æ ¡å›­", "é‡é€¢"], sweetness: "ç”œä¸­è‹¦", cleanliness: "åŒæ´", review: "å“­çˆ†", review_note: "", adaptations: [], ongoing: false, favorited: true, synopsis: "ä¸€æ®µå…³äºé”™è¿‡ä¸é‡é€¢ã€æˆé•¿ä¸æ•‘èµçš„æ ¡å›­æ•…äº‹ã€‚", cv_list: ["é’±æ–‡é’", "éƒ‘å¸Œ"] },
      { id: 5, title: "é¬’å¼ ", rating: 4.3, male_lead: "æ—æ— èµ‹ / ä¸éœ", cv: "èƒ¡è‰¯ä¼Ÿ / å¤§æ˜•", author: "å·«å“²", tags: ["æ ¡å›­"], sweetness: "ç”œ", cleanliness: "åŒæ´", review: "ç»†è…»", review_note: "", adaptations: [], ongoing: false, favorited: false, synopsis: "é¬’å¼ ä¸ä¸éœä¹‹é—´ç»†è…»çš„æƒ…æ„Ÿæˆé•¿æ•…äº‹ã€‚", cv_list: ["èƒ¡è‰¯ä¼Ÿ", "å¤§æ˜•"] },
      { id: 6, title: "æ”¾å­¦ç­‰æˆ‘", rating: 4.3, male_lead: "é™ˆæ™¯æ·± / å–»ç¹", cv: "å€’éœ‰æ­»å‹¿ / å‡Œé£", author: "é…±å­è´", tags: ["æ ¡å›­", "é‡é€¢"], sweetness: "ç”œä¸­è‹¦", cleanliness: "åŒæ´", review: "è½»æ¾æ¼‚æµ®", review_note: "", adaptations: [], ongoing: false, favorited: false, synopsis: "æ”¾å­¦è·¯ä¸Šçš„é‡é€¢ï¼Œä¸¤äººå‘½è¿å†æ¬¡äº¤ç¼ ã€‚", cv_list: ["å€’éœ‰æ­»å‹¿", "å‡Œé£"] },
      { id: 7, title: "ä¸‰ä¼", rating: 4.0, male_lead: "æ®µéå‡¡ / æ±Ÿé—»", cv: "å²æ³½é“  / å¼ ç¦æ­£", author: "å·«å“²", tags: ["å¤§å­¦", "æ ¡å›­"], sweetness: "ç”œ", cleanliness: "åŒæ´", review: "ç‰›è‚‰å¾ˆå¤š è„‘æ´æ–°å¥‡", review_note: "", adaptations: [], ongoing: false, favorited: false, synopsis: "ä¸‰ä¼å¤©é‡Œçš„å¤æ—¥æ•…äº‹ï¼Œå……æ»¡çƒ­çƒˆä¸é’æ¶©ã€‚", cv_list: ["å²æ³½é“ ", "å¼ ç¦æ­£"] },
      { id: 8, title: "åˆ¤å®˜", rating: 4.2, male_lead: "åä¸åˆ° / é—²æ—¶", cv: "èµµä¹¾ä¸š / å´é¦™", author: "æœ¨è‹é‡Œ", tags: ["å¤é£", "çˆ½é€†"], sweetness: "å¾®è‹¦", cleanliness: "åŒæ´", review: "", review_note: "", adaptations: [], ongoing: false, favorited: false, synopsis: "åˆ¤å®˜ä¸é¬¼é­‚ä¹‹é—´çº ç¼ çš„å¤é£æ•…äº‹ã€‚", cv_list: ["èµµä¹¾ä¸š", "å´é¦™"] },
      { id: 9, title: "å…¨çƒé«˜è€ƒ", rating: 4.5, male_lead: "ç§¦ç©¶ / ï¼Ÿ", cv: "éƒ‘å¸Œ / éƒ‘çŸ¥è¡Œ", author: "æœ¨è‹é‡Œ", tags: ["æ— é™æµ", "å¿«ç©¿ç³»ç»Ÿ"], sweetness: "è‹¦", cleanliness: "åŒæ´", review: "", review_note: "", adaptations: [], ongoing: true, favorited: true, synopsis: "é«˜è€ƒèƒŒæ™¯ä¸‹çš„æ— é™æµæ•…äº‹ï¼Œç”Ÿæ­»ä¹‹é—´çš„è€ƒéªŒã€‚", cv_list: ["éƒ‘å¸Œ", "éƒ‘çŸ¥è¡Œ"] },
      { id: 10, title: "ç½‘æ‹ç¿»è½¦æŒ‡å—", rating: 4.4, male_lead: "å‘å‡†ä¹‹ / æ™¯æ¬¢", cv: "å€’éœ‰æ­»å‹¿ / é¢–é“­å¿—", author: "é…±å­è´", tags: ["æ ¡å›­", "ç”µç«"], sweetness: "è¶…ç”œ", cleanliness: "åŒæ´", review: "æ— è„‘ç”œ", review_note: "", adaptations: [], ongoing: false, favorited: false, synopsis: "ä»ç½‘æ‹åˆ°ç°å®çš„ç”œèœœç¿»è½¦æ•…äº‹ã€‚", cv_list: ["å€’éœ‰æ­»å‹¿", "é¢–é“­å¿—"] },
      { id: 11, title: "æˆ‘è¡Œè®©æˆ‘æ¥", rating: 3.6, male_lead: "è·¯æ—­è¿œ / ç®€èš", cv: "å¶æ¸… / éœç£Š", author: "é…±å­è´", tags: ["ç”µç«"], sweetness: "ç”œ", cleanliness: "åŒæ´", review: "éš¾å¬", review_note: "", adaptations: [], ongoing: false, favorited: false, synopsis: "ç”µç«åœˆçš„çˆ±æ¨æƒ…ä»‡ã€‚", cv_list: ["å¶æ¸…", "éœç£Š"] },
      { id: 12, title: "æˆ‘å–œæ¬¢ä½ æœ‹å‹å¾ˆä¹…äº†", rating: 4.1, male_lead: "ä¸¥åµ© / è£´ç‚", cv: "é’±æ–‡é’ / å²æ³½é“ ", author: "é…±å­è´", tags: ["å¤§å­¦", "æ ¡å›­"], sweetness: "å•", cleanliness: "åŒæ´", review: "å°è°¢æŸ ", review_note: "", adaptations: [], ongoing: false, favorited: false, synopsis: "æš—æ‹äº†å¾ˆä¹…çš„æœ‹å‹ï¼Œç»ˆäºé¼“èµ·å‹‡æ°”å‘Šç™½ã€‚", cv_list: ["é’±æ–‡é’", "å²æ³½é“ "] },
      { id: 13, title: "fog", rating: 4.3, male_lead: "ä½™æ¼© / æ–‡æ£®", cv: "æ¼«æ¼«ä½•å…¶å¤š / é©¬æ­£é˜³", author: "é…±å­è´", tags: ["ç”µç«", "é‡é€¢"], sweetness: "ç”œ", cleanliness: "åŒæ´", review: "æ„Ÿæƒ…ç»†å†™ ç»†è…»çƒ­è¡€", review_note: "", adaptations: [], ongoing: false, favorited: false, synopsis: "é›¾ä¸­é‡é€¢ï¼Œä¸¤äººåœ¨ç”µç«èµ›åœºé‡æ‹¾å¾€æ—¥æƒ…ç¼˜ã€‚", cv_list: ["æ¼«æ¼«ä½•å…¶å¤š", "é©¬æ­£é˜³"] },
      { id: 14, title: "PUBGä¸–çºªç½‘æ‹", rating: 3.6, male_lead: "æ˜“ç® / ç¡®ç¡®", cv: "å€’éœ‰æ­»å‹¿ / æŸ’å¤œ", author: "é…±å­è´", tags: ["ç”µç«"], sweetness: "ç”œ", cleanliness: "åŒæ´", review: "æ²¡æ›´å®Œ", review_note: "æ²¡æ›´å®Œ", adaptations: [], ongoing: true, favorited: false, synopsis: "åœ¨PUBGæ¸¸æˆé‡Œå¼€å§‹çš„ä¸–çºªç½‘æ‹ã€‚", cv_list: ["å€’éœ‰æ­»å‹¿", "æŸ’å¤œ"] },
    ];

    const TABS = ["å…¨éƒ¨", "æ”¶è—", "è¿½æ›´ä¸­"];
    const VIEWS = ["ä½œå“", "æ”¶è—", "ä½œè€…", "CV"];
    const StarRating = ({ value, size = 20 }) => (
      <div style={{ display: "flex", gap: 2 }}>
        {[1, 2, 3, 4, 5].map(star => (
          <span
            key={star}
            style={{
              fontSize: size, cursor: "default",
              color: value >= star ? "#e8a838" : "#d4b896",
              lineHeight: 1
            }}
          >&#9733;</span>
        ))}
      </div>
    );

    const RatingBadge = ({ value }) => {
      const color = value >= 4.5 ? "#c84b31" : value >= 4.0 ? "#e8a838" : value >= 3.5 ? "#6b8c6e" : "#8e8e8e";
      return (
        <div style={{
          background: color, color: "#fff", borderRadius: 6,
          padding: "2px 8px", fontSize: 13, fontWeight: 700,
          fontFamily: "'DM Mono', monospace", letterSpacing: 0.5
        }}>{value.toFixed(1)}</div>
      );
    };

    const Tag = ({ label, color }) => (
      <span style={{
        background: color || "#f0e8d8", color: "#7a5c3a",
        borderRadius: 20, padding: "2px 9px", fontSize: 11,
        fontFamily: "'Noto Serif SC', serif", border: "1px solid #d4b896"
      }}>{label}</span>
    );

    const OngoingBadge = () => (
      <span style={{
        background: "linear-gradient(135deg, #e84040, #ff6b35)",
        color: "#fff", borderRadius: 20, padding: "2px 9px", fontSize: 10,
        fontWeight: 700, letterSpacing: 1, animation: "pulse 1.5s infinite"
      }}>
        â— è¿½æ›´ä¸­
      </span>
    );

    const AUTHOR_GRADIENTS = [
      "linear-gradient(135deg, #e84080, #c060e0)",
      "linear-gradient(135deg, #e8a838, #e06030)",
      "linear-gradient(135deg, #50a0d0, #6060d0)",
      "linear-gradient(135deg, #50b878, #30a0a0)",
      "linear-gradient(135deg, #d05070, #e08840)",
    ];
    const CV_GRADIENTS = [
      "linear-gradient(135deg, #5080e0, #40b8c0)",
      "linear-gradient(135deg, #d06070, #e0a030)",
      "linear-gradient(135deg, #9060c0, #5080e0)",
      "linear-gradient(135deg, #40a868, #50c0a0)",
      "linear-gradient(135deg, #c07040, #d0a030)",
    ];
    const Avatar = ({ name, gradients, size = 48 }) => {
      const idx = name.split("").reduce((s, c) => s + c.charCodeAt(0), 0) % gradients.length;
      return (
        <div style={{
          width: size, height: size, borderRadius: 12, flexShrink: 0,
          background: gradients[idx],
          display: "flex", alignItems: "center", justifyContent: "center",
          fontSize: size * 0.42, fontWeight: 700, color: "#fff",
          boxShadow: "0 4px 12px rgba(0,0,0,0.12)"
        }}>{name[0]}</div>
      );
    };

    const StatusBadge = ({ ongoing }) => (
      <span style={{
        background: ongoing ? "rgba(232,64,64,0.12)" : "rgba(100,140,100,0.12)",
        color: ongoing ? "#e84040" : "#6b8c6e",
        borderRadius: 20, padding: "2px 8px", fontSize: 10,
        fontWeight: 600, border: ongoing ? "1px solid rgba(232,64,64,0.25)" : "1px solid rgba(100,140,100,0.25)"
      }}>{ongoing ? "è¿½æ›´ä¸­" : "å·²å®Œç»“"}</span>
    );

    const Modal = ({ children, onClose }) => (
      <div onClick={onClose} style={{
        position: "fixed", inset: 0, background: "rgba(30,18,10,0.65)",
        backdropFilter: "blur(4px)", zIndex: 1000,
        display: "flex", alignItems: "center", justifyContent: "center", padding: 16
      }}>
        <div onClick={e => e.stopPropagation()} style={{
          background: "#fdf7ee", borderRadius: 20, padding: 28,
          width: "100%", maxWidth: 560, maxHeight: "90vh", overflowY: "auto",
          boxShadow: "0 24px 80px rgba(120,60,20,0.25), 0 0 0 1px #e8d5b8",
          animation: "slideUp 0.25s ease"
        }}>
          {children}
        </div>
      </div>
    );

    function App() {
      const dramas = initialDramas;
      const [activeTab, setActiveTab] = useState("å…¨éƒ¨");
      const [activeView, setActiveView] = useState("ä½œå“");
      const [sortBy, setSortBy] = useState("rating");
      const [search, setSearch] = useState("");
      const [detailTarget, setDetailTarget] = useState(null);
      const [selectedAuthor, setSelectedAuthor] = useState(null);
      const [selectedCV, setSelectedCV] = useState(null);

      const filtered = useMemo(() => {
        let list = dramas;
        if (activeTab === "æ”¶è—") list = list.filter(d => d.favorited);
        if (activeTab === "è¿½æ›´ä¸­") list = list.filter(d => d.ongoing);
        if (search) list = list.filter(d =>
          d.title.includes(search) || d.author.includes(search) ||
          d.male_lead.includes(search) || d.cv.includes(search)
        );
        return [...list].sort((a, b) => sortBy === "rating" ? b.rating - a.rating : a.title.localeCompare(b.title));
      }, [dramas, activeTab, search, sortBy]);

      const authorMap = useMemo(() => {
        const map = {};
        dramas.forEach(d => {
          if (!map[d.author]) map[d.author] = [];
          map[d.author].push(d);
        });
        return map;
      }, [dramas]);

      const cvMap = useMemo(() => {
        const map = {};
        dramas.forEach(d => {
          (d.cv_list || d.cv.split("/").map(s => s.trim())).forEach(cv => {
            if (!cv) return;
            if (!map[cv]) map[cv] = [];
            if (!map[cv].find(x => x.id === d.id)) map[cv].push(d);
          });
        });
        return map;
      }, [dramas]);

      const filteredFavorites = useMemo(() => {
        let list = dramas.filter(d => d.favorited);
        if (search) list = list.filter(d =>
          d.title.includes(search) || d.author.includes(search) ||
          d.male_lead.includes(search) || d.cv.includes(search)
        );
        return list.sort((a, b) => b.rating - a.rating);
      }, [dramas, search]);

      const authorList = useMemo(() => {
        let list = Object.entries(authorMap).sort((a, b) => b[1].length - a[1].length);
        if (search) list = list.filter(([author, works]) =>
          author.includes(search) || works.some(w =>
            w.title.includes(search) || w.cv.includes(search)
          )
        );
        return list;
      }, [authorMap, search]);

      const cvList = useMemo(() => {
        let list = Object.entries(cvMap).sort((a, b) => b[1].length - a[1].length);
        if (search) list = list.filter(([cv, works]) =>
          cv.includes(search) || works.some(w =>
            w.title.includes(search) || w.author.includes(search)
          )
        );
        return list;
      }, [cvMap, search]);

      const avgRating = (list) => list.length ? (list.reduce((s, d) => s + d.rating, 0) / list.length).toFixed(1) : "-";

      return (
        <div style={{
          minHeight: "100vh", background: "#f5ede0",
          fontFamily: "'Noto Serif SC', 'STSong', serif",
          backgroundImage: "url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23c8a880' fill-opacity='0.06'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")"
        }}>
          {/* Header */}
          <div style={{
            background: "linear-gradient(135deg, #4a2c1a 0%, #7a4530 60%, #3a1c0a 100%)",
            padding: "24px 20px 20px", position: "sticky", top: 0, zIndex: 100,
            boxShadow: "0 4px 24px rgba(30,10,0,0.3)"
          }}>
            <div style={{ maxWidth: 700, margin: "0 auto" }}>
              <div style={{ marginBottom: 16 }}>
                <div style={{ color: "#f5c880", fontSize: 22, fontWeight: 700, letterSpacing: 2 }}>ğŸ™ï¸ å¹¿æ’­å‰§è¿½è¸ª</div>
                <div style={{ color: "#c8a878", fontSize: 12, marginTop: 2 }}>å…± {dramas.length} éƒ¨ Â· {dramas.filter(d => d.favorited).length} æ”¶è— Â· {dramas.filter(d => d.ongoing).length} è¿½æ›´</div>
              </div>

              {/* View Tabs */}
              <div style={{ display: "flex", gap: 6, marginBottom: 12 }}>
                {VIEWS.map(v => (
                  <button key={v} className="tab-btn" onClick={() => setActiveView(v)} style={{
                    background: activeView === v ? "#f5c880" : "rgba(255,255,255,0.12)",
                    color: activeView === v ? "#4a2c1a" : "#d4b896",
                    border: "none", borderRadius: 8, padding: "5px 14px",
                    fontSize: 13, fontWeight: activeView === v ? 700 : 400, cursor: "pointer", transition: "all 0.2s"
                  }}>{v}</button>
                ))}
              </div>

              <div style={{ display: "flex", gap: 8, flexWrap: "wrap" }}>
                <input
                  value={search} onChange={e => setSearch(e.target.value)}
                  placeholder={activeView === "ä½œè€…" ? "æœç´¢ä½œè€…å/ä½œå“å..." : activeView === "CV" ? "æœç´¢CVå/ä½œå“å..." : "æœç´¢å‰§å/ä½œè€…/CV..."}
                  style={{
                    flex: 1, minWidth: 140, background: "rgba(255,255,255,0.12)", border: "1px solid rgba(255,255,255,0.2)",
                    borderRadius: 8, padding: "7px 12px", fontSize: 13, color: "#f5e8d0", outline: "none"
                  }}
                />
                {activeView === "ä½œå“" && (
                  <div style={{ display: "flex", gap: 6 }}>
                    {TABS.map(t => (
                      <button key={t} className="tab-btn" onClick={() => setActiveTab(t)} style={{
                        background: activeTab === t ? "rgba(245,200,128,0.3)" : "rgba(255,255,255,0.08)",
                        color: activeTab === t ? "#f5c880" : "#c8a878",
                        border: activeTab === t ? "1px solid #f5c880" : "1px solid rgba(255,255,255,0.15)",
                        borderRadius: 8, padding: "5px 12px", fontSize: 12, cursor: "pointer"
                      }}>{t}</button>
                    ))}
                    <button onClick={() => setSortBy(s => s === "rating" ? "title" : "rating")} style={{
                      background: "rgba(255,255,255,0.08)", border: "1px solid rgba(255,255,255,0.15)",
                      borderRadius: 8, padding: "5px 10px", fontSize: 12, color: "#c8a878", cursor: "pointer"
                    }}>{sortBy === "rating" ? "â†“è¯„åˆ†" : "â†•åç§°"}</button>
                  </div>
                )}
              </div>
            </div>
          </div>

          <div style={{ maxWidth: 700, margin: "0 auto", padding: "16px 12px 40px" }}>

            {/* ===== LIST VIEW ===== */}
            {activeView === "ä½œå“" && (
              <div style={{ display: "flex", flexDirection: "column", gap: 10, animation: "fadeIn 0.3s" }}>
                {filtered.length === 0 && (
                  <div style={{ textAlign: "center", padding: "60px 0", color: "#b09070" }}>æš‚æ— å†…å®¹</div>
                )}
                {filtered.map(drama => (
                  <div key={drama.id} className="drama-card" style={{
                    background: "#fdf7ee", borderRadius: 14, padding: "14px 16px",
                    boxShadow: "0 2px 12px rgba(120,60,20,0.1)", border: "1px solid #e8d5b8",
                    cursor: "pointer"
                  }} onClick={() => setDetailTarget(drama)}>
                    <div style={{ display: "flex", justifyContent: "space-between", alignItems: "flex-start", gap: 10 }}>
                      <div style={{ flex: 1, minWidth: 0 }}>
                        <div style={{ display: "flex", alignItems: "center", gap: 8, flexWrap: "wrap", marginBottom: 4 }}>
                          <span style={{ fontSize: 16, fontWeight: 700, color: "#3a2010" }}>{drama.title}</span>
                          {drama.ongoing && <OngoingBadge />}
                          {drama.favorited && <span style={{ color: "#e84040", fontSize: 16 }}>â™¥</span>}
                        </div>
                        <div style={{ fontSize: 12, color: "#9a7856", marginBottom: 6 }}>
                          <span>âœï¸ {drama.author}</span>
                          <span style={{ margin: "0 8px" }}>Â·</span>
                          <span>ğŸ¤ {drama.cv}</span>
                        </div>
                        <div style={{ display: "flex", gap: 5, flexWrap: "wrap" }}>
                          {drama.tags.map(t => <Tag key={t} label={t} />)}
                          <Tag label={drama.sweetness} color="#fce8d0" />
                          <Tag label={drama.cleanliness} color="#e8f0e0" />
                        </div>
                        {drama.review && (
                          <div style={{ marginTop: 6, fontSize: 12, color: "#7a5c3a", fontStyle: "italic" }}>
                            ğŸ’¬ {drama.review}
                          </div>
                        )}
                      </div>
                      <RatingBadge value={drama.rating} />
                    </div>
                  </div>
                ))}
              </div>
            )}

            {/* ===== FAVORITES VIEW ===== */}
            {activeView === "æ”¶è—" && (
              <div style={{ display: "flex", flexDirection: "column", gap: 10, animation: "fadeIn 0.3s" }}>
                {filteredFavorites.length === 0 && (
                  <div style={{ textAlign: "center", padding: "60px 0", color: "#b09070" }}>{search ? "æ— åŒ¹é…æ”¶è—" : "æš‚æ— æ”¶è—"}</div>
                )}
                {filteredFavorites.map(drama => (
                  <div key={drama.id} className="drama-card" style={{
                    background: "#fdf7ee", borderRadius: 14, padding: "14px 16px",
                    boxShadow: "0 2px 12px rgba(120,60,20,0.1)", border: "1px solid #e8d5b8",
                    cursor: "pointer"
                  }} onClick={() => setDetailTarget(drama)}>
                    <div style={{ display: "flex", justifyContent: "space-between", alignItems: "flex-start", gap: 10 }}>
                      <div style={{ flex: 1, minWidth: 0 }}>
                        <div style={{ display: "flex", alignItems: "center", gap: 8, flexWrap: "wrap", marginBottom: 4 }}>
                          <span style={{ fontSize: 16, fontWeight: 700, color: "#3a2010" }}>{drama.title}</span>
                          {drama.ongoing && <OngoingBadge />}
                          <span style={{ color: "#e84040", fontSize: 16 }}>â™¥</span>
                        </div>
                        <div style={{ fontSize: 12, color: "#9a7856", marginBottom: 6 }}>
                          <span>âœï¸ {drama.author}</span>
                          <span style={{ margin: "0 8px" }}>Â·</span>
                          <span>ğŸ¤ {drama.cv}</span>
                        </div>
                        <div style={{ display: "flex", gap: 5, flexWrap: "wrap" }}>
                          {drama.tags.map(t => <Tag key={t} label={t} />)}
                          <Tag label={drama.sweetness} color="#fce8d0" />
                          <Tag label={drama.cleanliness} color="#e8f0e0" />
                        </div>
                        {drama.review && (
                          <div style={{ marginTop: 6, fontSize: 12, color: "#7a5c3a", fontStyle: "italic" }}>
                            ğŸ’¬ {drama.review}
                          </div>
                        )}
                      </div>
                      <RatingBadge value={drama.rating} />
                    </div>
                  </div>
                ))}
              </div>
            )}

            {/* ===== AUTHOR VIEW ===== */}
            {activeView === "ä½œè€…" && (
              <div style={{ animation: "fadeIn 0.3s" }}>
                {selectedAuthor ? (
                  <div>
                    <button onClick={() => setSelectedAuthor(null)} style={{
                      background: "none", border: "none", color: "#c87020", cursor: "pointer",
                      fontSize: 14, marginBottom: 14, display: "flex", alignItems: "center", gap: 4
                    }}>â† è¿”å›ä½œè€…</button>
                    {/* Author detail header */}
                    <div style={{
                      background: "linear-gradient(135deg, #2a1810, #4a2c1a 40%, #3a2015)",
                      borderRadius: 16, padding: "20px", marginBottom: 14,
                      display: "flex", alignItems: "center", gap: 16,
                      boxShadow: "0 4px 20px rgba(30,10,0,0.3)"
                    }}>
                      <Avatar name={selectedAuthor} gradients={AUTHOR_GRADIENTS} size={56} />
                      <div style={{ flex: 1 }}>
                        <div style={{ fontSize: 20, fontWeight: 700, color: "#f5e8d0", marginBottom: 4 }}>{selectedAuthor}</div>
                        <div style={{ fontSize: 13, color: "#c8a878" }}>
                          {authorMap[selectedAuthor]?.length} éƒ¨ä½œå“ Â· <span style={{ color: "#e87060" }}>â™¥</span>{authorMap[selectedAuthor]?.filter(d => d.favorited).length}
                        </div>
                      </div>
                      <div style={{ textAlign: "right", flexShrink: 0 }}>
                        <div style={{ fontSize: 28, fontWeight: 700, color: "#f0a050", fontFamily: "'DM Mono', monospace", lineHeight: 1 }}>
                          {avgRating(authorMap[selectedAuthor])}
                        </div>
                        <div style={{ fontSize: 10, color: "#a08060", marginTop: 3, letterSpacing: 1 }}>å¹³å‡è¯„åˆ†</div>
                      </div>
                    </div>
                    {/* Drama cards with accent bar */}
                    <div style={{ display: "flex", flexDirection: "column", gap: 10 }}>
                      {authorMap[selectedAuthor]?.sort((a,b)=>b.rating-a.rating).map(drama => (
                        <div key={drama.id} className="drama-card" style={{
                          background: "#fdf7ee", borderRadius: 12,
                          boxShadow: "0 2px 10px rgba(120,60,20,0.08)", cursor: "pointer",
                          border: "1px solid #e8d5b8", display: "flex", overflow: "hidden"
                        }} onClick={() => { setSelectedAuthor(null); setDetailTarget(drama); }}>
                          <div style={{
                            width: 4, flexShrink: 0,
                            background: drama.rating >= 4.5 ? "linear-gradient(180deg, #e84040, #ff6b35)" : drama.rating >= 4.0 ? "linear-gradient(180deg, #e8a838, #e06830)" : "linear-gradient(180deg, #6b8c6e, #50a0a0)"
                          }} />
                          <div style={{ flex: 1, padding: "12px 14px", display: "flex", justifyContent: "space-between", alignItems: "center" }}>
                            <div>
                              <div style={{ fontWeight: 700, color: "#3a2010", fontSize: 15, marginBottom: 5 }}>{drama.title}</div>
                              <div style={{ display: "flex", gap: 6, alignItems: "center", flexWrap: "wrap" }}>
                                <StatusBadge ongoing={drama.ongoing} />
                                {drama.favorited && <span style={{ color: "#e84040", fontSize: 13 }}>â™¥</span>}
                              </div>
                            </div>
                            <StarRating value={Math.round(drama.rating)} size={14} />
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                ) : (
                  <div style={{ display: "flex", flexDirection: "column", gap: 10 }}>
                    <div style={{ fontSize: 13, color: "#9a7856", marginBottom: 4 }}>
                      å…± {authorList.length} ä½ä½œè€…{search && "ï¼ˆå·²ç­›é€‰ï¼‰"}
                    </div>
                    {authorList.length === 0 && (
                      <div style={{ textAlign: "center", padding: "60px 0", color: "#b09070" }}>æ— åŒ¹é…ä½œè€…</div>
                    )}
                    {authorList.map(([author, works]) => (
                      <div key={author} className="drama-card" onClick={() => setSelectedAuthor(author)} style={{
                        background: "#fdf7ee", borderRadius: 14, padding: "16px 18px",
                        boxShadow: "0 2px 12px rgba(120,60,20,0.1)", cursor: "pointer",
                        border: "1px solid #e8d5b8", display: "flex", alignItems: "center", gap: 14
                      }}>
                        <Avatar name={author} gradients={AUTHOR_GRADIENTS} size={48} />
                        <div style={{ flex: 1 }}>
                          <div style={{ fontWeight: 700, fontSize: 16, color: "#3a2010", marginBottom: 4 }}>{author}</div>
                          <div style={{ fontSize: 12, color: "#9a7856" }}>
                            {works.length} éƒ¨ä½œå“ Â· <span style={{ color: "#e87060" }}>â™¥</span>{works.filter(w => w.favorited).length}
                          </div>
                        </div>
                        <div style={{ textAlign: "right", flexShrink: 0 }}>
                          <div style={{ fontSize: 22, fontWeight: 700, color: "#c87020", fontFamily: "'DM Mono', monospace", lineHeight: 1 }}>
                            {avgRating(works)}
                          </div>
                          <div style={{ fontSize: 10, color: "#b09070", marginTop: 2, letterSpacing: 0.5 }}>å¹³å‡è¯„åˆ†</div>
                        </div>
                      </div>
                    ))}
                  </div>
                )}
              </div>
            )}

            {/* ===== CV VIEW ===== */}
            {activeView === "CV" && (
              <div style={{ animation: "fadeIn 0.3s" }}>
                {selectedCV ? (
                  <div>
                    <button onClick={() => setSelectedCV(null)} style={{
                      background: "none", border: "none", color: "#c87020", cursor: "pointer",
                      fontSize: 14, marginBottom: 14, display: "flex", alignItems: "center", gap: 4
                    }}>â† è¿”å›CV</button>
                    {/* CV detail header */}
                    <div style={{
                      background: "linear-gradient(135deg, #101828, #1a3a4a 40%, #152535)",
                      borderRadius: 16, padding: "20px", marginBottom: 14,
                      display: "flex", alignItems: "center", gap: 16,
                      boxShadow: "0 4px 20px rgba(10,20,40,0.3)"
                    }}>
                      <Avatar name={selectedCV} gradients={CV_GRADIENTS} size={56} />
                      <div style={{ flex: 1 }}>
                        <div style={{ fontSize: 20, fontWeight: 700, color: "#e0ecf4", marginBottom: 4 }}>{selectedCV}</div>
                        <div style={{ fontSize: 13, color: "#80a8c0" }}>
                          å‚ä¸ {cvMap[selectedCV]?.length} éƒ¨ä½œå“ Â· <span style={{ color: "#e87060" }}>â™¥</span>{cvMap[selectedCV]?.filter(d => d.favorited).length}
                        </div>
                      </div>
                      <div style={{ textAlign: "right", flexShrink: 0 }}>
                        <div style={{ fontSize: 28, fontWeight: 700, color: "#60b8d0", fontFamily: "'DM Mono', monospace", lineHeight: 1 }}>
                          {avgRating(cvMap[selectedCV])}
                        </div>
                        <div style={{ fontSize: 10, color: "#6090a8", marginTop: 3, letterSpacing: 1 }}>å¹³å‡è¯„åˆ†</div>
                      </div>
                    </div>
                    {/* Drama cards with accent bar */}
                    <div style={{ display: "flex", flexDirection: "column", gap: 10 }}>
                      {cvMap[selectedCV]?.sort((a,b)=>b.rating-a.rating).map(drama => (
                        <div key={drama.id} className="drama-card" style={{
                          background: "#fdf7ee", borderRadius: 12,
                          boxShadow: "0 2px 10px rgba(120,60,20,0.08)", cursor: "pointer",
                          border: "1px solid #e8d5b8", display: "flex", overflow: "hidden"
                        }} onClick={() => { setSelectedCV(null); setDetailTarget(drama); }}>
                          <div style={{
                            width: 4, flexShrink: 0,
                            background: drama.rating >= 4.5 ? "linear-gradient(180deg, #4090d0, #60c0e0)" : drama.rating >= 4.0 ? "linear-gradient(180deg, #5080c0, #6090d0)" : "linear-gradient(180deg, #6b8c6e, #50a0a0)"
                          }} />
                          <div style={{ flex: 1, padding: "12px 14px", display: "flex", justifyContent: "space-between", alignItems: "center" }}>
                            <div>
                              <div style={{ fontWeight: 700, color: "#3a2010", fontSize: 15, marginBottom: 5 }}>{drama.title}</div>
                              <div style={{ display: "flex", gap: 6, alignItems: "center", flexWrap: "wrap" }}>
                                <StatusBadge ongoing={drama.ongoing} />
                                {drama.favorited && <span style={{ color: "#e84040", fontSize: 13 }}>â™¥</span>}
                              </div>
                            </div>
                            <StarRating value={Math.round(drama.rating)} size={14} />
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                ) : (
                  <div style={{ display: "flex", flexDirection: "column", gap: 10 }}>
                    <div style={{ fontSize: 13, color: "#9a7856", marginBottom: 4 }}>å…± {cvList.length} ä½CV{search && "ï¼ˆå·²ç­›é€‰ï¼‰"}</div>
                    {cvList.length === 0 && (
                      <div style={{ textAlign: "center", padding: "60px 0", color: "#b09070" }}>æ— åŒ¹é…CV</div>
                    )}
                    {cvList.map(([cv, works]) => (
                      <div key={cv} className="drama-card" onClick={() => setSelectedCV(cv)} style={{
                        background: "#fdf7ee", borderRadius: 14, padding: "16px 18px",
                        boxShadow: "0 2px 12px rgba(120,60,20,0.1)", cursor: "pointer",
                        border: "1px solid #e8d5b8", display: "flex", alignItems: "center", gap: 14
                      }}>
                        <Avatar name={cv} gradients={CV_GRADIENTS} size={48} />
                        <div style={{ flex: 1 }}>
                          <div style={{ fontWeight: 700, fontSize: 16, color: "#1a3a4a", marginBottom: 4 }}>{cv}</div>
                          <div style={{ fontSize: 12, color: "#6888a0" }}>
                            {works.length} éƒ¨ä½œå“ Â· <span style={{ color: "#e87060" }}>â™¥</span>{works.filter(w => w.favorited).length}
                          </div>
                        </div>
                        <div style={{ textAlign: "right", flexShrink: 0 }}>
                          <div style={{ fontSize: 22, fontWeight: 700, color: "#2c5a6a", fontFamily: "'DM Mono', monospace", lineHeight: 1 }}>
                            {avgRating(works)}
                          </div>
                          <div style={{ fontSize: 10, color: "#8098a8", marginTop: 2, letterSpacing: 0.5 }}>å¹³å‡è¯„åˆ†</div>
                        </div>
                      </div>
                    ))}
                  </div>
                )}
              </div>
            )}
          </div>

          {/* ===== DETAIL MODAL ===== */}
          {detailTarget && (
            <Modal onClose={() => setDetailTarget(null)}>
              <div style={{ display: "flex", justifyContent: "space-between", alignItems: "flex-start", marginBottom: 16 }}>
                <div style={{ flex: 1, paddingRight: 10 }}>
                  <div style={{ display: "flex", flexWrap: "wrap", gap: 8, alignItems: "center", marginBottom: 6 }}>
                    <h2 style={{ fontSize: 22, fontWeight: 700, color: "#3a2010" }}>{detailTarget.title}</h2>
                    {detailTarget.ongoing && <OngoingBadge />}
                  </div>
                  <div style={{ display: "flex", gap: 8, alignItems: "center" }}>
                    <RatingBadge value={detailTarget.rating} />
                    <StarRating value={Math.round(detailTarget.rating)} size={16} />
                    {detailTarget.favorited && <span style={{ color: "#e84040", fontSize: 18 }}>â™¥ å·²æ”¶è—</span>}
                  </div>
                </div>
                <button onClick={() => setDetailTarget(null)} style={{
                  background: "none", border: "none", fontSize: 22, cursor: "pointer", color: "#9a7856"
                }}>âœ•</button>
              </div>

              <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 10, marginBottom: 14 }}>
                {[
                  ["âœï¸ ä½œè€…", detailTarget.author],
                  ["ğŸ­ ä¸»è§’", detailTarget.male_lead],
                  ["ğŸ¤ CV", detailTarget.cv],
                  ["ğŸ’ ç”œåº¦", detailTarget.sweetness],
                  ["ğŸŒ¸ æ´åº¦", detailTarget.cleanliness],
                ].map(([label, val]) => (
                  <div key={label} style={{ background: "#f5ede0", borderRadius: 8, padding: "8px 12px" }}>
                    <div style={{ fontSize: 11, color: "#a07850", marginBottom: 2 }}>{label}</div>
                    <div style={{ fontSize: 14, color: "#3a2010", fontWeight: 500 }}>{val}</div>
                  </div>
                ))}
              </div>

              <div style={{ marginBottom: 12 }}>
                <div style={{ fontSize: 11, color: "#a07850", marginBottom: 6 }}>ğŸ·ï¸ æ ‡ç­¾</div>
                <div style={{ display: "flex", gap: 6, flexWrap: "wrap" }}>
                  {detailTarget.tags.map(t => <Tag key={t} label={t} />)}
                </div>
              </div>

              {detailTarget.synopsis && (
                <div style={{ background: "#f5ede0", borderRadius: 10, padding: "12px 14px", marginBottom: 12 }}>
                  <div style={{ fontSize: 11, color: "#a07850", marginBottom: 5 }}>ğŸ“– ç®€ä»‹</div>
                  <div style={{ fontSize: 13, color: "#5a3a20", lineHeight: 1.7 }}>{detailTarget.synopsis}</div>
                </div>
              )}

              {detailTarget.review && (
                <div style={{ background: "linear-gradient(135deg, #fce8d0, #f5d4b0)", borderRadius: 10, padding: "10px 14px", marginBottom: 14 }}>
                  <div style={{ fontSize: 11, color: "#a07850", marginBottom: 4 }}>ğŸ’¬ æˆ‘çš„è¯„ä»·</div>
                  <div style={{ fontSize: 14, color: "#3a2010", fontWeight: 500 }}>{detailTarget.review}</div>
                  {detailTarget.review_note && <div style={{ fontSize: 12, color: "#7a5c3a", marginTop: 4 }}>{detailTarget.review_note}</div>}
                </div>
              )}

            </Modal>
          )}
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<App />);
  </script>
</body>
</html>
